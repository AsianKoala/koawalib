modified version of noah's jotai
